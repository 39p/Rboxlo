function hookUpDataListEvents(){console.log("[rboxlo->info]: modify::hookUpDataListEvents");let e=$(".delete-application"),a=$(".data-uuid-copy"),t=$(".data-lastDeployedVersionUUID-copy"),n=$(".data-internalName-copy");for(let a=0;a<e.length;a++){let t=e.eq(a);t.on("click",()=>{let e=t.parent().parent().attr("data-rboxlo-application-id");console.log(`[rboxlo->info]: modify::deleteApplicationModal | ID: "${e}"`),deleteApplicationModal(e)})}for(let e=0;e<a.length;e++){let t=a.eq(e);t.on("click",()=>{let e=t.parent().find(".data-uuid").text();console.log(`[rboxlo->info]: modify::data-uuid-copy | "${e}"`),copy(e)})}for(let e=0;e<t.length;e++){let a=t.eq(e);a.attr("disabled")||a.on("click",()=>{let e=a.parent().find(".data-lastDeployedVersionUUID").text();console.log(`[rboxlo->info]: modify::data-lastDeployedVersionUUID-copy | "${e}"`),copy(e)})}for(let e=0;e<n.length;e++){let a=n.eq(e);a.on("click",()=>{let e=a.parent().find(".data-internalName").text();console.log(`[rboxlo->info]: modify::data-internalName-copy | "${e}"`),copy(e)})}}function populate(e=!1){console.log(`[rboxlo->info]: modify::data | fetching data (initializing: ${e?"TRUE":"FALSE"})`),e||($("#data").addClass("d-none"),$("#data-loading").removeClass("d-none"));let a=$("#data-body");a.html(""),$("#data-empty").hasClass("d-none")||$("#data-empty").addClass("d-none"),fetch(url("/api/games/application/json")).then(e=>e.json()).then(e=>{0==e.length?($("#data-loading").addClass("d-none"),$("#data-empty").removeClass("d-none")):($(e).each((e,t)=>{let n=$("<tr>",{"data-rboxlo-application-id":t.id}),l=$("<td>",{class:"align-middle text-center table-button",scope:"row"}).append($("<a>",{href:url(`/games/application/modify?id=${t.id}`)}).append($("<button>",{class:"btn btn-primary btn-sm",type:"button"}).append($("<i>",{class:"fas fa-pencil"})))),s=$("<td>",{class:"align-middle text-center table-button",scope:"row"}).append($("<button>",{class:"btn btn-danger btn-sm delete-application",type:"button"}).append($("<i>",{class:"fas fa-trash"}))),o=$("<td>",{class:"align-middle text-center table-button",scope:"row"}).append($("<a>",{class:"btn btn-success btn-sm text-white",type:"button",href:url(`/games/application/deployment?id=${t.id}`)}).append($("<i>",{class:"fas fa-upload"}))),d=$("<td>",{class:"align-middle text-center"}).append(t.id),i=$("<td>",{class:"align-middle"}).append(t.displayName),p=$("<td>",{class:"align-middle"}).append($("<div>",{class:"d-flex justify-content-between align-items-center"}).append([$("<code>",{class:"data-internalName"}).append(t.internalName),$("<button>",{class:"btn btn-secondary btn-sm data-internalName-copy"}).append($("<i>",{class:"fas fa-clipboard"}))])),r=$("<td>",{class:"align-middle"}).append($("<div>",{class:"d-flex justify-content-between align-items-center"}).append([$("<code>",{class:"data-uuid"}).append(t.uuid),$("<button>",{class:"btn btn-secondary btn-sm data-uuid-copy"}).append($("<i>",{class:"fas fa-clipboard"}))])),c=$("<td>",{class:"align-middle"});t.lastDeployedVersionUUID.length>0?c.append($("<div>",{class:"d-flex justify-content-between align-items-center"}).append([$("<code>",{class:"data-lastDeployedVersionUUID"}).append(t.lastDeployedVersionUUID),$("<button>",{class:"btn btn-secondary btn-sm data-lastDeployedVersionUUID-copy"}).append($("<i>",{class:"fas fa-clipboard"}))])):c.append($("<div>",{class:"d-flex justify-content-between align-items-center"}).append([$("<i>",{class:"text-muted"}).append("none"),$("<button>",{class:"btn btn-secondary btn-sm",disabled:""}).append($("<i>",{class:"fas fa-clipboard"}))]));let m=$("<td>",{class:"align-middle"}).append(timestamp(t.lastUpdatedTimestamp)),u=$("<td>",{class:"align-middle"}).append(timestamp(t.createdTimestamp));n.append(l),n.append(s),n.append(o),n.append(d),n.append(i),n.append(p),n.append(r),n.append(c),n.append(m),n.append(u),a.append(n)}),hookUpDataListEvents(),setTimeout(()=>{$("#data-loading").addClass("d-none"),$("#data").removeClass("d-none")},200))})}function regenerateUUID(){let e=$("#regenerate-uuid-spinner");e.removeClass("d-none");let a=$('meta[name="rboxlo-application-id"]').attr("content"),t=$('meta[name="rboxlo-csrf"]').attr("content");fetch(url("/api/games/application/uuid"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({_csrf:t,id:a,method:"regenerate"})}).then(e=>e.json()).then(a=>{e.addClass("d-none");let t=$("#update");a.success?(t.hasClass("alert-danger")&&(t.removeClass("alert-danger"),t.addClass("alert-success")),t.text("Successfully regenerated application UUID!"),t.removeClass("d-none"),t.removeAttr("style"),$("#uuid").text(a.new),$("#last-updated").text(timestamp(moment().unix()))):(t.hasClass("alert-success")&&(t.removeClass("alert-success"),t.addClass("alert-danger")),t.text("Unknown error occurred"),t.removeClass("d-none"),t.removeAttr("style")),setTimeout(()=>{update.fadeOut("slow")},2250)})}function displayNameSubmit(){console.log("[rboxlo->info]: modify::displayNameSubmit");let e=$("#display-name-spinner"),a=$("#display-name-update");e.removeClass("d-none"),a.hasClass("d-none")||a.addClass("d-none");let t=$('meta[name="rboxlo-application-id"]').attr("content"),n=$('meta[name="rboxlo-csrf"]').attr("content"),l=$("#display-name-input"),s=$("#display-name-modal"),o=$("#update"),d=l.val();if(0==d.length)return a.hasClass("alert-success")&&(a.removeClass("alert-success"),a.addClass("alert-danger")),a.text("The new display name must not be empty."),void a.removeClass("d-none");fetch(url("/api/games/application/set"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({_csrf:n,id:t,column:"display_name",value:d})}).then(e=>e.json()).then(t=>{if(e.addClass("d-none"),t.success){o.hasClass("alert-danger")&&(o.removeClass("alert-danger"),o.addClass("alert-success")),o.text("Successfully updated display name!"),o.removeClass("d-none"),o.removeAttr("style"),l.val("");for(let e=0;e<$(".display-name").length;e++)$(".display-name").eq(e).text(d);$("#last-updated").text(timestamp(moment().unix())),setTimeout(()=>{parentAlert.fadeOut("slow")},2250),s.modal("toggle")}else a.hasClass("alert-success")&&(a.removeClass("alert-success"),a.addClass("alert-danger")),a.text("Unknown error occurred"),a.removeClass("d-none")})}function internalNameSubmit(){console.log("[rboxlo->info]: modify::internalNameSubmit");let e=$("#internal-name-spinner"),a=$("#internal-name-update");e.removeClass("d-none"),a.hasClass("d-none")||a.addClass("d-none");let t=$('meta[name="rboxlo-application-id"]').attr("content"),n=$('meta[name="rboxlo-csrf"]').attr("content"),l=$("#internal-name-input"),s=$("#internal-name-modal"),o=$("#update"),d=l.val();if(0==d.length)return a.hasClass("alert-success")&&(a.removeClass("alert-success"),a.addClass("alert-danger")),a.text("The new internal name must not be empty."),void a.removeClass("d-none");fetch(url("/api/games/application/set"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({_csrf:n,id:t,column:"internal_name",value:d})}).then(e=>e.json()).then(t=>{if(e.addClass("d-none"),t.success){o.hasClass("alert-danger")&&(o.removeClass("alert-danger"),o.addClass("alert-success")),o.text("Successfully updated internal name!"),o.removeClass("d-none"),o.removeAttr("style"),l.val("");for(let e=0;e<$(".internal-name").length;e++)$(".internal-name").eq(e).text(d);$("#last-updated").text(timestamp(moment().unix())),setTimeout(()=>{o.fadeOut("slow")},2250),s.modal("toggle")}else a.hasClass("alert-success")&&(a.removeClass("alert-success"),a.addClass("alert-danger")),a.text("Unknown error occurred"),a.removeClass("d-none")})}function deleteApplicationModal(e){$("#delete-application-submit").off("click").on("click",()=>{deleteApplication(e)}),$("#delete-application-modal").modal("show")}function deleteApplication(e,a=!1){console.log(`[rboxlo->info]: modify::deleteApplication | deleting application with ID ${e}`);let t=$('meta[name="rboxlo-csrf"]').attr("content"),n=$("#delete-spinner");n.removeClass("d-none"),fetch(url("/api/games/application/delete"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({_csrf:t,id:e})}).then(e=>e.json()).then(e=>{let t=$("#update");if(e.success){if(a)return void(window.location.href=url("/games/application/modify"));t.text(`Successfully deleted application "${e.deleted.displayName}"!`),t.removeClass("d-none"),t.removeAttr("style"),n.addClass("d-none"),$("#delete-application-modal").modal("hide"),populate(),setTimeout(()=>{t.fadeOut("slow")},2250)}})}$(document).ready(()=>{$("#data").length?($("#data-refresh").on("click",()=>{populate()}),populate(!0)):$(()=>{$("#regenerate-uuid").click(()=>{regenerateUUID()}),$("#display-name-submit").click(()=>{displayNameSubmit()}),$("#internal-name-submit").click(()=>{internalNameSubmit()}),$("#delete-application-submit").click(()=>{deleteApplication($('meta[name="rboxlo-application-id"]').attr("content"),!0)})})});