function unix2timestamp(e){return moment.unix(e).format("L @ h:mm A")}function copy(e){let a=$(`#${e}`).text();if(navigator.clipboard&&window.isSecureContext)navigator.clipboard.writeText(a);else{let e=$("<textarea>",{style:"position: fixed; top: 0; width: 2em; height: 2em; padding: 0; border: none; outline: none; boxShadow: none; background: transparent"});e.append(a),$(document.body).append(e),e.focus(),e.select();try{document.execCommand("copy")}catch(e){console.log(`failed to copy text ${a} because ${e}`)}e.remove()}}function fetchApplicationDataModify(e=!1){e||($("#data").addClass("d-none"),$("#data-loading").removeClass("d-none"));let a=$("#data-body");a.html(""),fetch(`${window.rboxlo.domain}/games/application/json`).then(e=>e.json()).then(e=>{0==e.length?($("#data-loading").addClass("d-none"),$("#data-empty").removeClass("d-none")):($(e).each((e,t)=>{let n=$("<tr>",{"data-rboxlo-application-id":t.id}),s=$("<td>",{class:"align-middle text-center table-button",scope:"row"}).append($("<a>",{href:`${window.rboxlo.domain}/games/application/modify?id=${t.id}`}).append($("<button>",{class:"btn btn-primary btn-sm",type:"button"}).append($("<i>",{class:"fas fa-pencil"})))),d=$("<td>",{class:"align-middle text-center table-button",scope:"row"}).append($("<button>",{class:"btn btn-danger btn-sm",type:"button"}).append($("<i>",{class:"fas fa-trash"}))),l=$("<td>",{class:"align-middle text-center table-button",scope:"row"}).append($("<a>",{class:"btn btn-success btn-sm text-white",type:"button",href:`${window.rboxlo.domain}/games/application/deployment?id=${t.id}`}).append($("<i>",{class:"fas fa-upload"}))),o=$("<td>",{class:"align-middle text-center"}).append(t.id),i=$("<td>",{class:"align-middle"}).append($("<div>",{class:"d-flex justify-content-between align-items-center"}).append([$("<code>",{id:`data-uuid-${t.id}`}).append(t.uuid),$("<button>",{class:"btn btn-secondary btn-sm",onclick:`copy('data-uuid-${t.id}')`}).append($("<i>",{class:"fas fa-clipboard"}))])),r=$("<td>",{class:"align-middle"});t.last_deployed_version_uuid.length>0?r.append($("<div>",{class:"d-flex justify-content-between align-items-center"}).append([$("<code>",{id:`data-lastVersionUUID-${t.id}`}).append(t.last_deployed_version_uuid),$("<button>",{class:"btn btn-secondary btn-sm",onclick:`copy('data-lastVersionUUID-${t.id}')`}).append($("<i>",{class:"fas fa-clipboard"}))])):r.append($("<div>",{class:"d-flex justify-content-between align-items-center"}).append([$("<i>",{class:"text-muted"}).append("none"),$("<button>",{class:"btn btn-secondary btn-sm",disabled:""}).append($("<i>",{class:"fas fa-clipboard"}))]));let p=$("<td>",{class:"align-middle"}).append($("<div>",{class:"d-flex justify-content-between align-items-center"}).append([$("<code>",{id:`data-internalName-${t.id}`}).append(t.internal_name),$("<button>",{class:"btn btn-secondary btn-sm",onclick:`copy('data-internalName-${t.id}')`}).append($("<i>",{class:"fas fa-clipboard"}))])),c=$("<td>",{class:"align-middle"}).append(t.display_name),m=$("<td>",{class:"align-middle"}).append(unix2timestamp(t.last_updated_timestamp)),u=$("<td>",{class:"align-middle"}).append(unix2timestamp(t.created_timestamp));n.append(s),n.append(d),n.append(l),n.append(o),n.append(i),n.append(r),n.append(p),n.append(c),n.append(m),n.append(u),a.append(n)}),setTimeout(()=>{$("#data-loading").addClass("d-none"),$("#data").removeClass("d-none")},200))})}function regenUUIDModify(){let e=$("#spinner-uuid");e.removeClass("d-none");let a=$('meta[name="rboxlo-application-id"]').attr("content"),t=$('meta[name="rboxlo-csrf"]').attr("content");fetch(`${window.rboxlo.domain}/games/application/regen-uuid`,{method:"POST",body:new URLSearchParams({id:a,_csrf:t})}).then(e=>e.json()).then(a=>{if(e.addClass("d-none"),a.success){let e=$("#modification-update");e.hasClass("alert-danger")&&(e.removeClass("alert-danger"),e.addClass("alert-success")),e.text("Successfully regenerated application UUID!"),e.removeClass("d-none"),e.removeAttr("style"),$("#uuid").text(a.newUUID),$("#lastUpdated").text(unix2timestamp(moment().unix()))}else update.hasClass("alert-success")&&(update.removeClass("alert-success"),update.addClass("alert-danger")),update.text("Unknown error occurred"),update.removeClass("d-none"),update.removeAttr("style");setTimeout(()=>{update.fadeOut("slow")},3250)})}function saveEditDisplayNameChanges(){let e=$("#spinner-editDisplayNameChanges"),a=$("#editDisplayNameModal"),t=$("#displayNameModalText"),n=$("#internalNameModalError"),s=$("#displayName"),d=$("#modification-update");n.hasClass("d-none")||n.addClass("d-none"),e.removeClass("d-none");let l=$('meta[name="rboxlo-application-id"]').attr("content"),o=$('meta[name="rboxlo-csrf"]').attr("content"),i=$("#editDisplayNameInput");if(0==i.val().length)return n.hasClass("alert-success")&&(n.removeClass("alert-success"),n.addClass("alert-danger")),n.text("The new display name must not be empty."),void n.removeClass("d-none");fetch(`${window.rboxlo.domain}/games/application/update-display-name`,{method:"POST",body:new URLSearchParams({id:l,_csrf:o,name:i.val()})}).then(e=>e.json()).then(l=>{e.addClass("d-none"),l.success?(d.hasClass("alert-danger")&&(d.removeClass("alert-danger"),d.addClass("alert-success")),d.text("Successfully updated display name!"),d.removeClass("d-none"),d.removeAttr(""),i.val(""),t.text(l.newName),s.text(l.newName),$("#displayNameHeader").text(l.newName),$("#lastUpdated").text(unix2timestamp(moment().unix())),setTimeout(()=>{d.fadeOut("slow")},3250),a.modal("toggle")):(n.hasClass("alert-success")&&(n.removeClass("alert-success"),n.addClass("alert-danger")),n.text("Unknown error occurred"),n.removeClass("d-none"))})}function saveEditInternalNameChanges(){let e=$("#spinner-editInternalNameChanges"),a=$("#editInternalNameModal"),t=$("#internalNameModalText"),n=$("#internalNameModalError"),s=$("#internalName"),d=$("#modification-update");n.hasClass("d-none")||n.addClass("d-none"),e.removeClass("d-none");let l=$('meta[name="rboxlo-application-id"]').attr("content"),o=$('meta[name="rboxlo-csrf"]').attr("content"),i=$("#editInternalNameInput");if(0==i.val().length)return n.hasClass("alert-success")&&(n.removeClass("alert-success"),n.addClass("alert-danger")),n.text("The new internal name must not be empty."),void n.removeClass("d-none");fetch(`${window.rboxlo.domain}/games/application/update-internal-name`,{method:"POST",body:new URLSearchParams({id:l,_csrf:o,name:i.val()})}).then(e=>e.json()).then(l=>{e.addClass("d-none"),l.success?(d.hasClass("alert-danger")&&(d.removeClass("alert-danger"),d.addClass("alert-success")),d.text("Successfully updated internal name!"),d.removeClass("d-none"),d.removeAttr(""),i.val(""),t.text(l.newName),s.text(l.newName),$("#lastUpdated").text(unix2timestamp(moment().unix())),setTimeout(()=>{d.fadeOut("slow")},3250),a.modal("toggle")):(n.hasClass("alert-success")&&(n.removeClass("alert-success"),n.addClass("alert-danger")),n.text("Unknown error occurred"),n.removeClass("d-none"))})}window.rboxlo=[],$(document).ready(()=>{let e=$("[laid]");e.each((e,a)=>{a=$(a),a.attr("laid")==window.rboxlo.laid&&(a.addClass("active"),a.find("a").addClass("text-white"))})});